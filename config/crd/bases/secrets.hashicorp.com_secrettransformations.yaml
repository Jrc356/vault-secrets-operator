# Copyright (c) HashiCorp, Inc.
# SPDX-License-Identifier: BUSL-1.1

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.13.0
  name: secrettransformations.secrets.hashicorp.com
spec:
  group: secrets.hashicorp.com
  names:
    kind: SecretTransformation
    listKind: SecretTransformationList
    plural: secrettransformations
    singular: secrettransformation
  scope: Namespaced
  versions:
  - name: v1beta1
    schema:
      openAPIV3Schema:
        description: SecretTransformation is the Schema for the secrettransformations
          API
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: SecretTransformationSpec defines the desired state of SecretTransformation
            properties:
              fieldFilter:
                description: FieldFilter provides filtering of the source secret data
                  before it is stored. Templated fields are not affected by filtering.
                properties:
                  excludes:
                    description: Excludes contains regex pattern for keys that should
                      be excluded from the K8s Secret Data.
                    items:
                      type: string
                    type: array
                  includes:
                    description: Includes contains regex patterns of keys that should
                      be included in the K8s Secret Data.
                    items:
                      type: string
                    type: array
                type: object
              templateSpecs:
                additionalProperties:
                  description: TemplateSpec provides inline templating configuration.
                  properties:
                    key:
                      description: Key that the rendered Text will be stored with
                        in the K8s Destination Secret. An empty value is allowed to
                        be empty when Source is true. If Source is false, then a value
                        must be provided.
                      type: string
                    source:
                      description: Source the template, the spec will not be rendered
                        to the K8s Secret data.
                      type: boolean
                    text:
                      description: Text contains the Go text template format. The
                        template references attributes from the data structure of
                        the source secret. Refer to https://pkg.go.dev/text/template
                        for more information.
                      type: string
                  required:
                  - text
                  type: object
                description: TemplateSpecs maps a template name to its TemplateSpec.
                type: object
            type: object
          status:
            description: SecretTransformationStatus defines the observed state of
              SecretTransformation
            properties:
              error:
                type: string
              valid:
                type: boolean
            required:
            - error
            - valid
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
